Теперь, когда у нас есть созданное приложение-функция, мы узнаем, как создавать, настраивать и выполнять функцию Azure.

### <a name="triggers"></a>Триггеры
Функции Azure управляются событиями и выполняются в ответ на событие, такое как получение HTTP-запроса или добавление сообщения в очередь. 

Тип события, которое инициирует функцию, называется триггером. Функциям Azure для настройки требуется хотя бы один триггер. В противном случае у нас не будет возможности запустить функцию.

 Azure поддерживает широкий ряд триггеров, в том числе:
* HTTPTrigger
* TimerTrigger
* Веб-перехватчик GitHub
* CosmosDBTrigger
* BlobTrigger
* QueueTrigger
* EventHubTrigger
* ServiceBusQueueTrigger
* ServiceBusTopicTrigger

### <a name="bindings"></a>Привязки
Привязки функций Azure — это декларативный способ подключения данных к функции программными средствами.

Привязки — это подключение к службам данных. Функция Azure без привязок, с одной или несколькими привязками позволяет получить доступ к нескольким источникам данных. Вы определяете их как входные или выходные привязки или привязки чтения или записи.

Предположим, у вас есть QueueTrigger, который запускает функцию, если в очередь добавляется большой двоичный объект. Для подключения к хранилищу BLOB-объектов Azure используется входная привязка большого двоичного объекта. 

Выходные привязки используются для сохранения данных. Например, они отправляют возвращаемое значение функции в хранилище таблиц Azure.

Полный список доступных привязок доступен в [документации по Azure](https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings#supported-bindings).

### <a name="a-sample-trigger-and-binding-functionjson"></a>Пример триггера и привязки (function.json)
Это пример определения триггера и привязки для функции. Обратите внимание, что, в зависимости от типа привязки, которую вы описываете, необходимо указать различные значения свойств. Каждая привязка также имеет направление, которое определяет, используется она для ввода или для вывода. Триггеры — это всегда входные привязки. В этом примере показана функция, которая запускается добавлением сообщения в очередь с именем **myqueue-items**. Затем она отправляет возвращаемое значение функции в таблицу **outTable** в хранилище таблиц Azure.

```javascript
{
  "bindings": [
    {
      "name": "order",
      "type": "queueTrigger",
      "direction": "in",
      "queueName": "myqueue-items",
      "connection": "MY_STORAGE_ACCT_APP_SETTING"
    },
    {
      "name": "$return",
      "type": "table",
      "direction": "out",
      "tableName": "outTable",
      "connection": "MY_TABLE_STORAGE_ACCT_APP_SETTING"
    }
  ]
}
```
## <a name="premade-functions-and-templates"></a>Готовые функции и шаблоны
Azure предоставляет предварительно настроенные шаблоны для распространенных сценариев функций Azure.

### <a name="quickstart-templates"></a>Шаблоны быстрого запуска
Чтобы добавить функцию Azure, необходимо выбрать приложение-функцию. Приложение-функцию можно определить по значку молнии в остроконечных скобках.  
![Значок функции](../images/5-function-icon.png)

При добавлении первой функции Azure откроется экран быстрого запуска. На этом экране можно выбрать необходимый тип триггера и язык программирования. Затем Azure автоматически создаст код функции и конфигурацию с учетом выбранных параметров.  
![Быстрый запуск функции](../images/5-quickstart-form.png)

### <a name="function-templates"></a>Шаблоны функций
Выбор шаблона не ограничивается представленными на экране быстрого запуска. Вы можете выбрать один из более чем 30 шаблонов. Вы можете открыть экран списка шаблонов при создании последующих функций или выбрав параметр **Пользовательская функция** на экране быстрого запуска.  
![Шаблоны функций](../images/5-template-list.png)

## <a name="navigating-to-your-function-and-files"></a>Переход к функции и файлам
После создания функции на основе шаблона создается несколько файлов. Предположим, что вы решили использовать веб-перехватчик + API быстрого запуска с использованием JavaScript. Будут созданы файл конфигурации **function.json** и файл исходного кода **index.js**. При доступе к приложению-функции откроется дерево меню с функциями, созданными в приложении. В этом меню **Функции** вы также можете добавлять дополнительные функции для приложения-функции (при наведении указателя на элемент меню появится знак плюса "+").  
![Кнопка "Добавить функцию"](../images/5-function-add-button.png) 

Если вы раскрываете меню **Функции** в представлении в виде дерева на экране быстрого запуска, вы увидите одну функцию с именем по умолчанию **HttpTriggerJS1** (также обозначается значком функции f). При выборе этой функции откроется окно кода с исходным файлом **index.js**. Справа от окна кода есть всплывающее меню, которое содержит вкладку **Просмотр файлов**. Откройте эту вкладку, чтобы просмотреть структуру файлов (соответствующую расположению в хранилище), из которой состоит ваша функция.  
![Шаблоны функций](../images/5-file-navigation.png)

## <a name="execution-options-for-testing-your-azure-function"></a>Параметры выполнения для тестирования функции Azure
После создания функции Azure вам нужно будет узнать, как ее протестировать. Существует несколько подходов: выполнение вручную и тестирование на самом портале Azure.

### <a name="manual-execution-of-a-function"></a>Выполнение функции вручную
Вы можете выполнить функцию, вручную запустив настроенный триггер. К примеру, если вы используете HttpTrigger, вы можете использовать такое средство, как Postman или cURL, чтобы инициировать HTTP-запрос по URL-адресу конечной точки функции.  
![Выполнение функции с помощью Postman](../images/5-postman-execution.png). URL-адрес конечной точки можно получить, выбрав триггер HTTP в области навигации слева, а затем нажав на кнопку **Получить URL-адрес функции**.  
![Получить URL-адрес функции](../images/5-get-function-url.png)

### <a name="testing-a-function-in-the-azure-portal"></a>Тестирование функции на портале Azure
Портал Azure также предоставляет удобный способ для тестирования функций. В правой части окна кода есть всплывающее меню с вкладками. В меню есть элемент **Тест**. Разверните меню и выберите эту вкладку, чтобы выполнить функцию и посмотреть результат. Если вы используете триггер HttpTrigger, вы можете задать метод HTTP и добавить в запрос параметры строки запроса и заголовки HTTP. Вы также можете изменить текст запроса для тестирования дополнительных сценариев. В окне вывода отображается результат, возвращаемый функцией.  
![Выполнение функции на портале](../images/5-portal-execution.png)

## <a name="monitoring-an-azure-function"></a>Мониторинг функции Azure
Во время разработки функции Azure очень важно иметь возможность вносить сообщения в журнал и определять сценарии исключений, чтобы подготовить функции к рабочей среде. Это так же важно в рабочем сценарии, когда вы ищете источник сбоя. Портал Azure предоставляет пользовательский интерфейс с панелью мониторинга и возможностью просмотра журналов выполнения и исключений, полученных из функций Azure.

### <a name="monitoring-dashboard"></a>Панель мониторинга
В меню навигации приложения-функции разверните узел функции, и увидите элемент меню **Монитор**. На панели мониторинга можно быстро просматривать историю выполнений этой функции. В этом представлении отображаются метки времени, код результата, длительность и идентификатор операции, а также успешность выполнения. Данные заполняются с помощью Azure Application Insights.  
![Монитор функции](../images/5-monitor-function.png)

### <a name="log-window"></a>Окно журнала
Вы можете добавлять в функцию операторы журнала. Эти операторы будут отображаться в окне журнала функции. Окно журнала находится во всплывающем меню с вкладками, расположенном в нижней части окна кода. При использовании функции на базе JavaScript необходимо добавить оператор журнала, используя следующий синтаксис:
```javascript
  context.log('Enter your logging statement here');
```  
![Окно журнала](../images/5-log-window.png)

### <a name="errors-and-warnings-window"></a>Окно "Ошибки и предупреждения"
Вкладка "Ошибки и предупреждения" находится в том же всплывающем меню, что и окно журнала. В этом окне отображаются ошибки и предупреждения компиляции кода. Поскольку JavaScript — это динамический и интерпретируемый язык, на следующем изображении показана ошибка компиляции в функции C#.  
![Окно "Ошибки и предупреждения"](../images/5-errors-window.png)
