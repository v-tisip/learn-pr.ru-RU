Многие приложения используют события для уведомления распределенных компонентов о каких-либо происшествиях или изменениях в каком-либо объекте. Для распределения событий через Azure можно использовать сетку событий.

Предположим, у вас есть приложение для обмена музыкой с веб-API, который работает в Azure. Когда какой-либо пользователь загружает новый звуковой файл, необходимо уведомить об этом все мобильные устройства, установленные на устройствах пользователей по всему миру.

Сделать это быстро и надежно можно с помощью подписок на сетку событий Azure.

## <a name="what-is-event-grid"></a>Что такое сетка событий?

Сетка событий Azure — это служба, которая распределяет события из источников, таких как учетные записи хранения BLOB-объектов Azure или службы мультимедиа, для подписчиков, такие как функции Azure или веб-перехватчики.

Источник события — это любой компонент, который может создать событие. Например, пользователь может добавить новый медиафайл в учетную запись хранилища BLOB-объектов. При этом создается событие, которое сетка событий может распространить.

Подписчик события — это любой компонент, который может получать события из сетки событий. Например, функция Azure может выполнить код в ответ на новый медиафайл в учетной записи хранилища BLOB-объектов.

Сетка событий упрощает подключение источников к нескольким подписчикам.

![Источники и подписчики сетки событий](../images/6-event-grid.png)

## <a name="event-sources"></a>Источники событий

События могут создаваться с использованием следующих типов ресурсов Azure:

- **Подписки и группы ресурсов Azure.** Подписки и группы ресурсов создают события, связанные с операциями управления в Azure. Например, этот источник создает событие, когда пользователь создает виртуальную машину.
- **Учетные записи хранения.** Учетные записи хранения могут создавать события, когда пользователи добавляют BLOB-объекты, файлы, записи в таблице или очереди сообщений. И учетные записи BLOB-объектов, и учетные записи общего назначения можно использовать как источники событий.
- **Службы мультимедиа.** Службы мультимедиа содержат видео- и аудиофайлы и предоставляют расширенные функции управления медиафайлами. Службы мультимедиа могут создавать события при запуске или по завершении кодирования видеофайла.
- **Центр Интернета вещей.** Центр Интернета вещей (IoT) Azure использует и собирает данные телеметрии с устройств Интернета вещей. Он может создавать события при получении таких сообщений.
- **Пользовательские события.** Пользовательские события могут создаваться с использованием API REST или пакета Azure SDK для Java, GO, .NET, Node, Python и Ruby. Например, можно задать создание пользовательского события в рабочей роли веб-приложения Azure, когда она извлекает сообщение из очереди хранилища.

Благодаря широкой интеграции с различными источниками событий в Azure сетки событий могут распределять события, связанные практически с любыми ресурсами Azure.

## <a name="topics"></a>Разделы

В сетке событий Azure разделом называется коллекция связанных событий. При публикации событий из источника можно решить, требуется ли этим событиям только один раздел или их нужно разбить на несколько разделов. Компоненты, которые получают и обрабатывают события, подписываются на разделы, определяя, таким образом, какие события они будут получать.

## <a name="subscriptions"></a>Подписки

Обработчики событий используют подписки, чтобы сообщить сетке событий, какие события в разделе они хотят получать. Подписка также фиксирует конечную точку — это место, куда сетка событий отправляет уведомления о событиях. Кроме того, подписка может фильтровать события по типам или теме, чтобы обработчик событий получал только важные события.

## <a name="event-handlers"></a>Обработчики событий

Получать и обрабатывать события из сетки событий могут следующие типы объектов в Azure:

- **Функции Azure.** Функция Azure состоит из пользовательского кода, который выполняется в Azure без виртуального сервера или контейнера. Используйте функцию Azure как обработчик событий, если вам нужно написать код для пользовательского ответа на событие.
- **Веб-перехватчики.** Веб-перехватчик — это веб-API, реализующий архитектуру push-уведомлений.
- **Приложения логики.** Приложение логики Azure размещает бизнес-процесс как рабочий.
- **Microsoft Flow.** В Microsoft Flow также размещаются рабочие процессы, но с ним легче работать нетехническому персоналу.

## <a name="how-to-choose"></a>Как выбрать

Использование сетки событий дает следующие преимущества:

- **Простота.** Подключать источники к подписчикам в сетке событий очень просто.
- **Расширенная фильтрация.** Подписки тщательно контролируют то, какие события они получают из раздела.
- **Развертывание.** На одни и те же события и разделы можно подписать неограниченное количество конечных точек.
- **Надежность.** Сетка событий предпринимает повторные попытки доставки событий для каждой подписки в течение 24 часов.
- **Оплата за событие.** Оплата взымается только за то количество событий, которые вы передали.

## <a name="summary"></a>Сводка

Сетка событий — это простая, но универсальная система распространения событий. Публикуйте с ее помощью события для подписчиков, которые будут получать эти события надежно и быстро.