<span data-ttu-id="4db48-101">Предположим, вы планируете архитектуру распределенного приложения для обмена музыкой.</span><span class="sxs-lookup"><span data-stu-id="4db48-101">Suppose you are planning the architecture of a distributed music-sharing application.</span></span> <span data-ttu-id="4db48-102">Вам необходимо обеспечить максимальную надежность и масштабируемость приложения, и вы намереваетесь использовать технологии Azure для создания эффективной инфраструктуры обмена данными.</span><span class="sxs-lookup"><span data-stu-id="4db48-102">You want to ensure that the application is as reliable and scalable as possible and you intend to use Azure technologies to build a robust communication infrastructure.</span></span>

<span data-ttu-id="4db48-103">Чтобы выбрать подходящую технологию Azure, необходимо понимать, какими именно данными обмениваются компоненты приложения.</span><span class="sxs-lookup"><span data-stu-id="4db48-103">Before you can choose the right Azure technology, you must understand each individual communication that the components of the application exchange.</span></span> <span data-ttu-id="4db48-104">Для каждого типа данных можно выбрать свою технологию Azure.</span><span class="sxs-lookup"><span data-stu-id="4db48-104">For each communication you can choose a different Azure technology.</span></span>

<span data-ttu-id="4db48-105">В первую очередь следует понимать, отправляются ли сообщения или события.</span><span class="sxs-lookup"><span data-stu-id="4db48-105">The first thing to understand about a communication is whether it sends messages or events.</span></span> <span data-ttu-id="4db48-106">Некоторые технологии Azure предназначены для событий, а другие — для сообщений, поэтому это принципиальный вопрос.</span><span class="sxs-lookup"><span data-stu-id="4db48-106">Some Azure technologies target events and other target messages so this is a fundamental choice.</span></span>

## <a name="what-is-a-message"></a><span data-ttu-id="4db48-107">Что такое сообщение?</span><span class="sxs-lookup"><span data-stu-id="4db48-107">What is a message?</span></span>

<span data-ttu-id="4db48-108">В терминах распределенных приложений **сообщения** обладают указанными ниже характеристиками.</span><span class="sxs-lookup"><span data-stu-id="4db48-108">In the terminology of distributed applications, **messages** have the following characteristics:</span></span>

- <span data-ttu-id="4db48-109">Сообщение содержит необработанные данные, которые создаются одним компонентом и будут использоваться другим.</span><span class="sxs-lookup"><span data-stu-id="4db48-109">A message contains raw data, produced by one component, that will be consumed by another component.</span></span>
- <span data-ttu-id="4db48-110">Сообщение содержит сами данные, а не просто ссылку на них.</span><span class="sxs-lookup"><span data-stu-id="4db48-110">A message contains the data itself, not just a reference to that data.</span></span>
- <span data-ttu-id="4db48-111">Отправляющий компонент предполагает, что компонент-получатель будет обрабатывать содержимое сообщения определенным образом.</span><span class="sxs-lookup"><span data-stu-id="4db48-111">The sending component expects the message content to be processed in a certain way by the destination component.</span></span> <span data-ttu-id="4db48-112">Целостность всей системы может зависеть от выполнения отправляющей и принимающей сторонами определенных задач.</span><span class="sxs-lookup"><span data-stu-id="4db48-112">The integrity of the overall system may depend on both sender and receiver doing a specific job.</span></span>

<span data-ttu-id="4db48-113">Например, предположим, что пользователь добавляет новую песню с помощью мобильного приложения для обмена музыкой.</span><span class="sxs-lookup"><span data-stu-id="4db48-113">For example, suppose a user uploads a new song by using the mobile music-sharing app.</span></span> <span data-ttu-id="4db48-114">Мобильное приложение должно отправить эту песню в веб-API, работающий в Azure.</span><span class="sxs-lookup"><span data-stu-id="4db48-114">The mobile app must send that song to the web API that runs in Azure.</span></span> <span data-ttu-id="4db48-115">Необходимо отправить сам файл мультимедиа, а не просто оповещение о добавлении новой песни.</span><span class="sxs-lookup"><span data-stu-id="4db48-115">The song media file itself must be sent, not just an alert that indicates that a new song has been added.</span></span> <span data-ttu-id="4db48-116">Мобильное приложение предполагает, что веб-API сохранит новую песню в базе данных и откроет к ней доступ для других пользователей.</span><span class="sxs-lookup"><span data-stu-id="4db48-116">The mobile app expects that the web API will store the new song in the database and make it available to other users.</span></span> <span data-ttu-id="4db48-117">Это пример сообщения.</span><span class="sxs-lookup"><span data-stu-id="4db48-117">This is an example of a message.</span></span>

## <a name="what-is-an-event"></a><span data-ttu-id="4db48-118">Что такое событие?</span><span class="sxs-lookup"><span data-stu-id="4db48-118">What is an event?</span></span>

<span data-ttu-id="4db48-119">**События** имеют меньший размер, чем сообщения, и чаще всего применяются для широковещательной рассылки.</span><span class="sxs-lookup"><span data-stu-id="4db48-119">**Events** are lighter-weight than messages and are most often used for broadcast communications.</span></span> <span data-ttu-id="4db48-120">Компоненты, отправляющие события, называются **издателями**, а принимающие их — **подписчиками**.</span><span class="sxs-lookup"><span data-stu-id="4db48-120">The components sending the event are known as **publishers** and receivers are known as **subscribers**.</span></span>

<span data-ttu-id="4db48-121">Принимающие компоненты обычно решают, какие события их интересуют, и "подписываются" на них.</span><span class="sxs-lookup"><span data-stu-id="4db48-121">With events, receiving components will generally decide in which communications they are interested and "subscribe" to those.</span></span> <span data-ttu-id="4db48-122">Управление подпиской, как правило, осуществляет посредник, например Сетка событий Azure или Центр событий Azure.</span><span class="sxs-lookup"><span data-stu-id="4db48-122">The subscription is usually managed by an intermediary like Azure Event Grid or Azure Event Hub.</span></span> <span data-ttu-id="4db48-123">Когда издатель отправляет событие, посредник направляет его соответствующим подписчикам.</span><span class="sxs-lookup"><span data-stu-id="4db48-123">When publishers send an event, the intermediary will route that event to interested subscribers.</span></span> <span data-ttu-id="4db48-124">Такая схема называется архитектурой типа "публикация-подписка". Это не единственный способ обработки событий, но наиболее распространенный.</span><span class="sxs-lookup"><span data-stu-id="4db48-124">This is known as a "publish-subscribe architecture", it is not the only way to deal with events, but it is the most common.</span></span>

<span data-ttu-id="4db48-125">События обладают указанными ниже характеристиками.</span><span class="sxs-lookup"><span data-stu-id="4db48-125">Events have the following characteristics:</span></span>

- <span data-ttu-id="4db48-126">Событие — это упрощенное уведомление о том, что нечто произошло.</span><span class="sxs-lookup"><span data-stu-id="4db48-126">An event is a lightweight notification that indicates that something happened.</span></span>
- <span data-ttu-id="4db48-127">Событие может отправляться нескольким получателям или ни одному.</span><span class="sxs-lookup"><span data-stu-id="4db48-127">The event may be sent to multiple receivers or to none at all.</span></span>
- <span data-ttu-id="4db48-128">События часто предполагают рассылку, то есть у одного издателя может быть много подписчиков.</span><span class="sxs-lookup"><span data-stu-id="4db48-128">Events are often intended to "fan-out" or have a large number of subscribers for each publisher.</span></span>
- <span data-ttu-id="4db48-129">У издателя события нет ожиданий относительно того, какое действие предпримет принимающий компонент.</span><span class="sxs-lookup"><span data-stu-id="4db48-129">The publisher of the event has no expectation about the action a receiving component takes.</span></span>
- <span data-ttu-id="4db48-130">Некоторые события являются дискретными и не связаны с другими событиями.</span><span class="sxs-lookup"><span data-stu-id="4db48-130">Some events are discrete units and unrelated to other events.</span></span> 
- <span data-ttu-id="4db48-131">Другие входят в связанные и упорядоченные последовательности.</span><span class="sxs-lookup"><span data-stu-id="4db48-131">Some events are part of a related and ordered series.</span></span>  

<span data-ttu-id="4db48-132">Например, предположим, что отправка музыкального файла завершилась и новая песня была добавлена в базу данных.</span><span class="sxs-lookup"><span data-stu-id="4db48-132">For example, suppose the music file upload has been completed and the new song has been added to the database.</span></span> <span data-ttu-id="4db48-133">Чтобы пользователи веб-интерфейса и мобильного приложения узнали об этом, веб-API должен оповестить их.</span><span class="sxs-lookup"><span data-stu-id="4db48-133">In order to inform users of the new file, the web API must inform the web front-end and mobile app users of the new file.</span></span> <span data-ttu-id="4db48-134">Пользователи сами решают, хотят ли они прослушать новую песню, поэтому начальное уведомление не должно содержать музыкальный файл, а только сообщать о его существовании.</span><span class="sxs-lookup"><span data-stu-id="4db48-134">The users can choose whether to listen to the new song, so the initial notification does not include the music file but only notifies users that the song exists.</span></span> <span data-ttu-id="4db48-135">Отправитель не предполагает, что получатели события выполнят какое-либо конкретное действие в ответ на получение события.</span><span class="sxs-lookup"><span data-stu-id="4db48-135">The sender does not have a specific expectation that the event receivers will do anything particular in response the receiving this event.</span></span>

<span data-ttu-id="4db48-136">Это пример дискретного события.</span><span class="sxs-lookup"><span data-stu-id="4db48-136">This is an example of a discrete event.</span></span>

## <a name="how-to-choose-messages-or-events"></a><span data-ttu-id="4db48-137">Выбор сообщений или событий</span><span class="sxs-lookup"><span data-stu-id="4db48-137">How to choose messages or events</span></span>

<span data-ttu-id="4db48-138">В приложении, как правило, события используются в одних целях, а сообщения — в других.</span><span class="sxs-lookup"><span data-stu-id="4db48-138">A single application is likely to use events for some purposes and messages for others.</span></span> <span data-ttu-id="4db48-139">Перед тем как делать выбор, следует проанализировать архитектуру приложения и все сценарии его применения, чтобы определить, в каких целях его компоненты взаимодействуют друг с другом.</span><span class="sxs-lookup"><span data-stu-id="4db48-139">Before you choose, you must analyze your application architecture and all its use cases to identify all the different purposes its components have to communicate with each other.</span></span> 

<span data-ttu-id="4db48-140">События чаще используются для широковещательной рассылки, которая может быть безрезультативной, если ни один получатель в настоящее время не подписан на них.</span><span class="sxs-lookup"><span data-stu-id="4db48-140">Events are more likely to be used for broadcasts and are often ephemeral, meaning a communication might not be handled by any receiver if none are currently subscribing.</span></span> <span data-ttu-id="4db48-141">Сообщения же обычно применяются, когда распределенному приложению требуется гарантия того, что данные будут обработаны.</span><span class="sxs-lookup"><span data-stu-id="4db48-141">Messages are more likely to be used where the distributed application requires a guarantee that the communication will be processed.</span></span>

<span data-ttu-id="4db48-142">Для каждого взаимодействия необходимо ответить на вопрос: предполагает ли отправляющий компонент, что получатель обработает переданное содержимое определенным образом?</span><span class="sxs-lookup"><span data-stu-id="4db48-142">For each communication consider the question: Does the sending component expect the communication to be processed in a particular way by the destination component?</span></span>

<span data-ttu-id="4db48-143">Если ответ утвердительный, используйте сообщения.</span><span class="sxs-lookup"><span data-stu-id="4db48-143">If the answer is yes, choose to use a message.</span></span> <span data-ttu-id="4db48-144">Если отрицательный, можно использовать события.</span><span class="sxs-lookup"><span data-stu-id="4db48-144">If the answer is no, you may be able to use events.</span></span>

## <a name="summary"></a><span data-ttu-id="4db48-145">Сводка</span><span class="sxs-lookup"><span data-stu-id="4db48-145">Summary</span></span>

<span data-ttu-id="4db48-146">Компоненты распределенного приложения взаимодействуют друг с другом в различных целях.</span><span class="sxs-lookup"><span data-stu-id="4db48-146">The components of a distributed application communicate with each other for many different purposes.</span></span> <span data-ttu-id="4db48-147">В каждом случае необходимо решить, следует ли использовать события или сообщения. От этого будет зависеть выбор соответствующей технологии Azure.</span><span class="sxs-lookup"><span data-stu-id="4db48-147">For each of these purposes, you must choose whether to use events or messages so that you can choose an Azure technology that is designed for that purpose.</span></span> 

<span data-ttu-id="4db48-148">Определив цели взаимодействия между компонентами и выбрав события или сообщения, вы можете далее решить, следует ли применять для обмена данными очереди службы хранилища Azure, Центры событий, Сетки событий или Служебную шину.</span><span class="sxs-lookup"><span data-stu-id="4db48-148">Having understood why your components communicate and whether they use events or messages, you can proceed to choose from Azure Storage queues, Event Hubs, Event Grids, or Service Bus to exchange the information.</span></span>