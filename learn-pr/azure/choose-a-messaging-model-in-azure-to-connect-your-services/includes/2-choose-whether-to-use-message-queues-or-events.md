<span data-ttu-id="33921-101">Предположим, вы планируете архитектуру распределенного приложения для обмена музыкой.</span><span class="sxs-lookup"><span data-stu-id="33921-101">Suppose you are planning the architecture of a distributed music-sharing application.</span></span> <span data-ttu-id="33921-102">Вам необходимо обеспечить максимальную надежность и масштабируемость приложения, и вы намереваетесь использовать технологии Azure для создания эффективной инфраструктуры обмена данными.</span><span class="sxs-lookup"><span data-stu-id="33921-102">You want to ensure that the application is as reliable and scalable as possible, and you intend to use Azure technologies to build a robust communication infrastructure.</span></span>

<span data-ttu-id="33921-103">Чтобы выбрать подходящую технологию Azure, необходимо понимать, какими именно данными обмениваются компоненты приложения.</span><span class="sxs-lookup"><span data-stu-id="33921-103">Before you can choose the right Azure technology, you must understand each individual communication that the components of the application exchange.</span></span> <span data-ttu-id="33921-104">Для каждого типа данных можно выбрать свою технологию Azure.</span><span class="sxs-lookup"><span data-stu-id="33921-104">For each communication you can choose a different Azure technology.</span></span>

<span data-ttu-id="33921-105">В первую очередь следует понимать, отправляются ли **сообщения** или **события**.</span><span class="sxs-lookup"><span data-stu-id="33921-105">The first thing to understand about a communication is whether it sends **messages** or **events**.</span></span> <span data-ttu-id="33921-106">Это самое важное решение, которое поможет вам выбрать соответствующую службу Azure.</span><span class="sxs-lookup"><span data-stu-id="33921-106">This is a fundamental choice that will help you choose the appropriate Azure service to use.</span></span>

## <a name="what-is-a-message"></a><span data-ttu-id="33921-107">Что такое сообщение?</span><span class="sxs-lookup"><span data-stu-id="33921-107">What is a message?</span></span>
<span data-ttu-id="33921-108">В терминах распределенных приложений **сообщения** обладают указанными ниже характеристиками.</span><span class="sxs-lookup"><span data-stu-id="33921-108">In the terminology of distributed applications, **messages** have the following characteristics:</span></span>

- <span data-ttu-id="33921-109">Сообщение содержит необработанные данные, которые создаются одним компонентом и будут использоваться другим.</span><span class="sxs-lookup"><span data-stu-id="33921-109">A message contains raw data, produced by one component, that will be consumed by another component.</span></span>
- <span data-ttu-id="33921-110">Сообщение содержит сами данные, а не просто ссылку на них.</span><span class="sxs-lookup"><span data-stu-id="33921-110">A message contains the data itself, not just a reference to that data.</span></span>
- <span data-ttu-id="33921-111">Отправляющий компонент предполагает, что компонент-получатель будет обрабатывать содержимое сообщения определенным образом.</span><span class="sxs-lookup"><span data-stu-id="33921-111">The sending component expects the message content to be processed in a certain way by the destination component.</span></span> <span data-ttu-id="33921-112">Целостность всей системы может зависеть от выполнения отправляющей и принимающей сторонами определенных задач.</span><span class="sxs-lookup"><span data-stu-id="33921-112">The integrity of the overall system may depend on both sender and receiver doing a specific job.</span></span>

<span data-ttu-id="33921-113">Например, предположим, что пользователь добавляет новую песню с помощью мобильного приложения для обмена музыкой.</span><span class="sxs-lookup"><span data-stu-id="33921-113">For example, suppose a user uploads a new song by using the mobile music-sharing app.</span></span> <span data-ttu-id="33921-114">Мобильное приложение должно отправить эту песню в веб-API, работающий в Azure.</span><span class="sxs-lookup"><span data-stu-id="33921-114">The mobile app must send that song to the web API that runs in Azure.</span></span> <span data-ttu-id="33921-115">Необходимо отправить сам файл мультимедиа, а не просто оповещение о добавлении новой песни.</span><span class="sxs-lookup"><span data-stu-id="33921-115">The song media file itself must be sent, not just an alert that indicates that a new song has been added.</span></span> <span data-ttu-id="33921-116">Мобильное приложение предполагает, что веб-API сохранит новую песню в базе данных и откроет к ней доступ для других пользователей.</span><span class="sxs-lookup"><span data-stu-id="33921-116">The mobile app expects that the web API will store the new song in the database and make it available to other users.</span></span> <span data-ttu-id="33921-117">Это пример сообщения.</span><span class="sxs-lookup"><span data-stu-id="33921-117">This is an example of a message.</span></span>

## <a name="what-is-an-event"></a><span data-ttu-id="33921-118">Что такое событие?</span><span class="sxs-lookup"><span data-stu-id="33921-118">What is an event?</span></span>

<span data-ttu-id="33921-119">**События** имеют меньший размер, чем сообщения, и чаще всего применяются для широковещательной рассылки.</span><span class="sxs-lookup"><span data-stu-id="33921-119">**Events** are lighter weight than messages, and are most often used for broadcast communications.</span></span> <span data-ttu-id="33921-120">Компоненты, отправляющие события, называются **издателями**, а принимающие их — **подписчиками**.</span><span class="sxs-lookup"><span data-stu-id="33921-120">The components sending the event are known as **publishers**, and receivers are known as **subscribers**.</span></span>

<span data-ttu-id="33921-121">Принимающие компоненты обычно решают, какие события их интересуют, и "подписываются" на них.</span><span class="sxs-lookup"><span data-stu-id="33921-121">With events, receiving components will generally decide in which communications they are interested, and will "subscribe" to those.</span></span> <span data-ttu-id="33921-122">Управление подпиской, как правило, осуществляет посредник, например Сетка событий Azure или Центр событий Azure.</span><span class="sxs-lookup"><span data-stu-id="33921-122">The subscription is usually managed by an intermediary, like Azure Event Grid or Azure Event Hubs.</span></span> <span data-ttu-id="33921-123">Когда издатель отправляет событие, посредник направляет его соответствующим подписчикам.</span><span class="sxs-lookup"><span data-stu-id="33921-123">When publishers send an event, the intermediary will route that event to interested subscribers.</span></span> <span data-ttu-id="33921-124">Это называется «архитектурой публикации и подписки».</span><span class="sxs-lookup"><span data-stu-id="33921-124">This is known as a "publish-subscribe architecture."</span></span> <span data-ttu-id="33921-125">Это не единственный способ обработки событий, но самый распространенный.</span><span class="sxs-lookup"><span data-stu-id="33921-125">It is not the only way to deal with events, but it is the most common.</span></span>

<span data-ttu-id="33921-126">События обладают указанными ниже характеристиками.</span><span class="sxs-lookup"><span data-stu-id="33921-126">Events have the following characteristics:</span></span>

- <span data-ttu-id="33921-127">Событие — это упрощенное уведомление о том, что нечто произошло.</span><span class="sxs-lookup"><span data-stu-id="33921-127">An event is a lightweight notification that indicates that something happened.</span></span>
- <span data-ttu-id="33921-128">Событие может отправляться нескольким получателям или ни одному.</span><span class="sxs-lookup"><span data-stu-id="33921-128">The event may be sent to multiple receivers, or to none at all.</span></span>
- <span data-ttu-id="33921-129">События часто предполагают рассылку, то есть у одного издателя может быть много подписчиков.</span><span class="sxs-lookup"><span data-stu-id="33921-129">Events are often intended to "fan out," or have a large number of subscribers for each publisher.</span></span>
- <span data-ttu-id="33921-130">У издателя события нет ожиданий относительно того, какое действие предпримет принимающий компонент.</span><span class="sxs-lookup"><span data-stu-id="33921-130">The publisher of the event has no expectation about the action a receiving component takes.</span></span>
- <span data-ttu-id="33921-131">Некоторые события являются дискретными и не связаны с другими событиями.</span><span class="sxs-lookup"><span data-stu-id="33921-131">Some events are discrete units and unrelated to other events.</span></span> 
- <span data-ttu-id="33921-132">Другие входят в связанные и упорядоченные последовательности.</span><span class="sxs-lookup"><span data-stu-id="33921-132">Some events are part of a related and ordered series.</span></span>  

<span data-ttu-id="33921-133">Например, предположим, что отправка музыкального файла завершилась и новая песня была добавлена в базу данных.</span><span class="sxs-lookup"><span data-stu-id="33921-133">For example, suppose the music file upload has been completed, and the new song has been added to the database.</span></span> <span data-ttu-id="33921-134">Чтобы пользователи веб-интерфейса и мобильного приложения узнали об этом, веб-API должен оповестить их.</span><span class="sxs-lookup"><span data-stu-id="33921-134">In order to inform users of the new file, the web API must inform the web front end and mobile app users of the new file.</span></span> <span data-ttu-id="33921-135">Пользователи сами решают, хотят ли они прослушать новую песню, поэтому начальное уведомление не должно содержать музыкальный файл, а только сообщать о его существовании.</span><span class="sxs-lookup"><span data-stu-id="33921-135">The users can choose whether to listen to the new song, so the initial notification does not include the music file but only notifies users that the song exists.</span></span> <span data-ttu-id="33921-136">Отправитель не предполагает, что получатели события выполнят какое-либо конкретное действие в ответ на получение события.</span><span class="sxs-lookup"><span data-stu-id="33921-136">The sender does not have a specific expectation that the event receivers will do anything particular in response the receiving this event.</span></span>

<span data-ttu-id="33921-137">Это пример дискретного события.</span><span class="sxs-lookup"><span data-stu-id="33921-137">This is an example of a discrete event.</span></span>

## <a name="how-to-choose-messages-or-events"></a><span data-ttu-id="33921-138">Выбор сообщений или событий</span><span class="sxs-lookup"><span data-stu-id="33921-138">How to choose messages or events</span></span>

<span data-ttu-id="33921-139">В приложении, как правило, события используются в одних целях, а сообщения — в других.</span><span class="sxs-lookup"><span data-stu-id="33921-139">A single application is likely to use events for some purposes and messages for others.</span></span> <span data-ttu-id="33921-140">Перед тем как делать выбор, следует проанализировать архитектуру приложения и все сценарии его применения, чтобы определить, в каких целях его компоненты взаимодействуют друг с другом.</span><span class="sxs-lookup"><span data-stu-id="33921-140">Before you choose, you must analyze your application architecture and all its use cases to identify all the different purposes its components have to communicate with each other.</span></span> 

<span data-ttu-id="33921-141">События чаще используются для широковещательной рассылки, которая может быть безрезультативной, если ни один получатель в настоящее время не подписан на них.</span><span class="sxs-lookup"><span data-stu-id="33921-141">Events are more likely to be used for broadcasts and are often ephemeral, meaning a communication might not be handled by any receiver if none are currently subscribing.</span></span> <span data-ttu-id="33921-142">Сообщения же обычно применяются, когда распределенному приложению требуется гарантия того, что данные будут обработаны.</span><span class="sxs-lookup"><span data-stu-id="33921-142">Messages are more likely to be used where the distributed application requires a guarantee that the communication will be processed.</span></span>

<span data-ttu-id="33921-143">Для каждого взаимодействия необходимо ответить на вопрос: **предполагает ли отправляющий компонент, что получатель обработает переданное содержимое определенным образом?**</span><span class="sxs-lookup"><span data-stu-id="33921-143">For each communication, consider the following question: **Does the sending component expect the communication to be processed in a particular way by the destination component?**</span></span>

<span data-ttu-id="33921-144">Если ответ _утвердительный_, используйте сообщения.</span><span class="sxs-lookup"><span data-stu-id="33921-144">If the answer is _yes_, choose to use a message.</span></span> <span data-ttu-id="33921-145">Если _отрицательный_, можно использовать события.</span><span class="sxs-lookup"><span data-stu-id="33921-145">If the answer is _no_, you may be able to use events.</span></span>

<span data-ttu-id="33921-146">Понимание того, как компоненты должны взаимодействовать, поможет вам выбрать способ их взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="33921-146">Understanding how your components need to communicate will help you to choose how your components will communicate.</span></span> <span data-ttu-id="33921-147">Начнем с сообщений.</span><span class="sxs-lookup"><span data-stu-id="33921-147">Let's start with messages.</span></span>