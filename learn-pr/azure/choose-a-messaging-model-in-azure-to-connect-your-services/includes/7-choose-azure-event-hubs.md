Некоторые приложения создают очень большое количество событий из многочисленных источников. В таких случаях часто применяется термин "большие данные". Для обработки больших данных требуется особая инфраструктура.

Предположим, вы работаете в компании Contoso, производящей авиадвигатели. Эти двигатели оснащаются сотнями датчиков. Перед вылетом самолета в рейс его двигатели подключаются к испытательному стенду и тщательно проверяются. Кроме того, при подключении самолета к наземному оборудованию передаются кэшированные полетные данные.

Вам необходимо найти в записанных показаниях датчиков закономерности, которые указывают на возможность возникновения неисправности двигателя в ближайшем будущем. Затем наличие таких закономерностей будет проверяться в показаниях датчиков, получаемых в режиме реального времени. Если показания двигателя вызывают беспокойство, пользователи получают предупреждение почти в реальном времени.

## <a name="what-is-azure-event-hubs"></a>Что такое Центры событий Azure

Центр событий Azure выступает в роли посредника в схеме взаимодействия "публикация-подписка". В отличие от Сетки событий, он оптимизирован для очень высокой пропускной способности и большого числа издателей, а также обеспечивает высокий уровень безопасности и устойчивости.

В то время как Сетка событий почти идеально укладывается в схему "публикация-подписка", так как она просто управляет подписками и перенаправляет данные подписчикам, Центр событий выполняет достаточно много дополнительных задач. По этой причине он больше похож на служебную шину или очередь сообщений, чем на простое средство широковещательной рассылки сообщений.

#### <a name="partitions"></a>Разделы ####
Получая данные, Центр событий распределяет их по секциям. Секции — это буферы, в которых сохраняются переданные данные. Из-за буферов события не являются полностью эфемерными. Событие не оказывается недоставленным только из-за того, что подписчик занят или недоступен. Подписчик всегда может обратиться к буферу, чтобы получить пропущенные события. По умолчанию события хранятся в буфере 24 часа, после чего их срок действия автоматически истекает.

Буферы называются секциями, так как данные делятся между ними. Каждый Центр событий имеет по крайней мере две секции, а каждая секция имеет отдельный набор подписчиков.

#### <a name="capture"></a>Регистрация ####
Центр событий может немедленно отправлять все события в Azure Data Lake или хранилище BLOB-объектов, которые обеспечивают экономичное долгосрочное хранение.

#### <a name="authentication"></a>Authentication ####
Все издатели проходят проверку подлинности и получают токен. Это означает, что Центр событий может принимать события от внешних устройств и мобильных приложений без риска того, что злоумышленники смогут повлиять на анализ с помощью ложных данных. 

## <a name="using-azure-event-hub"></a>Использование Центра событий Azure

Центры событий поддерживают передачу потоков событий по конвейеру в другие службы Azure. Например, их использование со Stream Analytics позволяет проводить сложный анализ данных почти в реальном времени с возможностью сопоставлять множество событий и находить закономерности. В этом случае Stream Analytics считается подписчиком.

В нашем примере мы настроим архитектуру так, чтобы Центры событий проверяли подлинность данных, получаемых от авиадвигателей. Затем с помощью функции "Сбор" все данные будут сохраняться в Azure Data Lake. В дальнейшем с помощью этих данных можно будет переобучать и совершенствовать модели машинного обучения. Наконец, потоки событий будут приниматься подписчиками Azure Stream Analytics. Служба Stream Analytics будет использовать модель машинного обучения для нахождения в показаниях датчиков закономерностей, которые могут указывать на проблемы.

Так как у нас несколько секций и каждый двигатель отправляет данные только в одну из них, каждый экземпляр подписчика Stream Analytics обрабатывает только часть данных. Ему не требуется фильтровать и сопоставлять весь их объем.

## <a name="choose-event-grid-or-event-hub"></a>Выбор Сетки событий или Центра событий

Оба решения поддерживают семантику *по крайней мере один раз*.

Если вам нужна простая инфраструктура публикации событий и подписки на них с доверенными издателями (например, с собственным веб-сервером), следует выбрать сетку событий Azure.

### <a name="consider-event-hub-if"></a>Используйте Центр событий в следующих случаях:
* вам нужно поддерживать проверку подлинности большого количества издателей;
* вам необходимо сохранять поток событий в Azure Data Lake или хранилище BLOB-объектов;
* вам необходимо осуществлять агрегирование или анализ потока событий;
* вам необходимо обеспечить надежный обмен сообщениями или устойчивость. 