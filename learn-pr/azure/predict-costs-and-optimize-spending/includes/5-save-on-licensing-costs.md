Лицензирование — это еще одна область, которая может значительно повлиять на ваши вложения в облачные технологии. Давайте рассмотрим некоторые варианты сокращения затрат на лицензирование.

## <a name="azure-hybrid-benefit-for-windows-server"></a>Преимущество гибридного использования Azure для Windows Server

Многие клиенты вложили свои средства в лицензии Windows Server и хотели бы перенести эти инвестиции в Azure. Преимущество гибридного использования Azure позволяет клиентам применять эти лицензии для виртуальных машин в Azure. Это означает, что плата за лицензию Windows Server не взимается, а выставляется счет по тарифу Linux. 

Чтобы иметь право на это преимущество, ваши лицензии Windows должны попадать под действие соглашения Software Assurance. Необходимо соблюдать следующие указания.

- В каждой лицензии, рассчитанной на использование двух процессоров, или каждом наборе лицензий, рассчитанном на предоставление 16 ядер, может предусматриваться либо два экземпляра на 8 ядер, либо один экземпляр на 16 ядер. 
- Лицензии на выпуск Standard Edition можно использовать только один раз: либо локально, либо в среде Azure. Это означает, что для виртуальной машины Azure и локального компьютера следует использовать разные лицензии.
- Преимущества для выпуска Datacenter Edition можно использовать и локально, и в среде Azure. Таким образом, лицензия будет действовать для двух работающих компьютеров Windows. 

> [!NOTE]
> Как правило, для большинства клиента действует модель лицензирования "на ядро", поэтому именно она будет применяться при расчете. Чтобы узнать, какие лицензии находятся в вашем распоряжении, обратитесь к торговому посреднику, занимающемуся лицензиями, или в отдел по работе с клиентами Майкрософт.

Применить преимущество очень просто. Если у вас уже есть виртуальные машины, его можно включить и отключить в любое время. Или же его можно применить во время развертывания новых виртуальных машин. Преимущество гибридного использования (особенно в сочетании с зарезервированными экземплярами) обеспечивает значительное сокращение затрат на лицензирование.

## <a name="azure-hybrid-benefit-for-sql-server"></a>Преимущество гибридного использования Azure для SQL Server

Преимущество гибридного использования Azure для SQL Server позволяет использовать текущие инвестиции в лицензирование по максимуму и ускорить миграцию в облако. Преимущество гибридного использования Azure для SQL Server — это преимущество Azure, благодаря которому вы можете использовать лицензии SQL Server с действующим предложением Software Assurance для снижения тарифа.

Вы можете воспользоваться этим преимуществом, даже если ресурс Azure активен, но обратите внимание, что сниженный тариф будет применяться с момента его выбора на портале. Кредит не будет выдаваться на предыдущий период.

### <a name="azure-sql-database-vcore-based-options"></a>Варианты для базы данных Azure SQL при использовании модели приобретения на основе виртуальных ядер

![Зачет лицензии SQL Server](../images/sql-tradein-value.jpg)

Для базы данных SQL Azure преимущество гибридного использования Azure работает следующим образом.

- При наличии лицензий на выпуск Standard Edition "на ядро" с действующим предложением Software Assurance можно получить одно виртуальное ядро на уровне служб общего назначения для каждого локального лицензированного ядра.
- При наличии лицензий на выпуск Enterprise Edition "на ядро" с действующим предложением Software Assurance можно получить одно виртуальное ядро на уровне важных для бизнеса служб для каждого локального лицензированного ядра. Обратите внимание, что преимущество гибридного использования Azure для SQL Server для уровня важных для бизнеса служб доступно только клиентам с лицензиями на выпуск Enterprise Edition.
- При наличии лицензий на выпуск Enterprise Edition "на ядро" с высоким уровнем виртуализации с действующим предложением Software Assurance можно получить одно виртуальное ядро на уровне служб общего назначения для каждого локального лицензированного ядра. Это уникальное преимущество виртуализации доступно только в базе данных SQL Azure.

Для SQL Server на виртуальных машинах Azure преимущество гибридного использования Azure работает следующим образом.

- При наличии лицензий на выпуск Enterprise Edition "на ядро" с действующим предложением Software Assurance можно получить одно ядро выпуска SQL Server Enterprise Edition на виртуальных машинах для каждого локального лицензированного ядра.
- При наличии лицензий на выпуск Standard Edition "на ядро" с действующим предложением Software Assurance можно получить одно ядро выпуска SQL Server Standard Edition на виртуальных машинах для каждого локального лицензированного ядра.

Это может значительно сократить расходы на рабочие нагрузки SQL Server в Azure.

## <a name="use-devtest-subscription-offers"></a>Использование предложений по подписке для разработки и тестирования

Предложения [выпуска Enterprise (для разработки и тестирования)](https://azure.microsoft.com/offers/ms-azr-0148p/) и [оплаты по мере использования (для разработки и тестирования)](https://azure.microsoft.com/offers/ms-azr-0023p/) позволяют сокращать затраты в непроизводственных средах. Эти преимущества позволяют получать несколько скидок, в основном касающихся рабочих нагрузок Windows, что исключает взимание платы за лицензии и предусматривает выставление счетов на виртуальные машины по ставке за Linux. Это также применимо к SQL Server и другому программному обеспечению Майкрософт, на которое распространяется действие подписки Visual Studio (прежнее название — MSDN). Для использования этого преимущества следует учитывать несколько требований, одно из которых заключается в том, что оно действует только для непроизводственных рабочих нагрузок, а другое в том, что на всех пользователей этих сред (за исключением инженеров-испытателей) должна распространяться подписка Visual Studio. Короче говоря, при использовании непроизводственных рабочих нагрузок этот вариант позволяет сэкономить средства для рабочих нагрузок Windows, SQL Server и других рабочих нагрузок виртуальных машин Майкрософт.
Ниже приведено подробное описание каждого предложения. Если вы являетесь клиентом, заключившим соглашение Enterprise Agreement, следует использовать предложение выпуска Enterprise (для разработки и тестирования), а если вы являетесь пользователем без соглашения Enterprise Agreement и вместо него используете учетные записи PAYG, следует выбрать предложение оплаты по мере использования (для разработки и тестирования).

## <a name="bring-your-own-sql-server-license"></a>Использование собственной лицензии SQL Server

Если вы являетесь клиентом, заключившим соглашение Enterprise Agreement, и уже вложили средства в лицензии SQL Server, которые освободились в ходе переноса ресурсов в Azure, вы можете подготовить образы **собственной лицензии** в Azure Marketplace и затем использовать эти свободные лицензии, чтобы снизить затраты на виртуальные машины Azure. Это всегда можно было сделать путем подготовки виртуальной машины Windows и установки SQL Server вручную, но за счет использования сертифицированных образов Майкрософт процесс создания существенно упрощается. Чтобы найти эти образы в Marketplace, выполните поиск по сокращению **BYOL**.

![Использование собственной лицензии для SQL Server в Azure](../images/byol-sql-server.png)

> [!IMPORTANT]
> Для использования этих сертифицированных образов BYOL требуется подписка по соглашению Enterprise Agreement.

## <a name="use-sql-server-developer-edition"></a>Использование SQL Server Developer Edition

Большинство людей не знает, что SQL Server Developer Edition является бесплатным продуктом для **использования в непроизводственной среде**. Выпуск Developer Edition имеет те же функции, что и Enterprise Edition, но позволяет сократить расходы на лицензирование непроизводственных рабочих нагрузок.

Найдите образы SQL Server Developer Edition в Azure Marketplace и используйте их для разработки и тестирования, чтобы избежать возможных в таких случаях дополнительных затрат на SQL Server. 

> [!NOTE]
> Полные сведения о лицензировании см. в [руководстве по ценообразованию](https://docs.microsoft.com/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-server-pricing-guidance).

## <a name="use-constrained-instance-sizes-for-database-workloads"></a>Использование экземпляров ограниченных размеров для рабочих нагрузок баз данных 

Многие клиенты предъявляют высокие требования к памяти, хранилищу или пропускной способности операций ввода-вывода, но рассчитывают на небольшое количество ядер ЦП. Принимая во внимание этот популярный запрос, корпорация Майкрософт выпустила самые распространенные размеры виртуальных машин (DS, ES, GS и MS) в новых видах, которые ограничивают количество виртуальных ЦП вдвое или вчетверо от исходного размера виртуальной машины, сохраняя при этом тот же объем памяти, хранилища и пропускную способность ввода-вывода.

| Размер виртуальной машины | Число виртуальных ЦП | Память | Максимальное количество дисков | Максимальная пропускная способность ввода-вывода | Затраты на лицензирование SQL Server Enterprise в год | Общая сумма затрат в год (вычисление и лицензирование) |
|---------|-------|--------|-----------|--------------------|-----------------------------------------------|---------------------------|
| Standard_DS14v2   | 16 | 112 ГБ | 32 | 51 200 операций ввода-вывода в секунду (IOPS) или 768 МБ/с |           |           |
| Standard_DS14-4v2 | **4**  | 112 ГБ | 32 | 51 200 операций ввода-вывода в секунду (IOPS) или 768 МБ/с | на 75 % ниже | на 57 % ниже |
| Standard_GS5      | 32 | 448    | 64 | 80 000 операций ввода-вывода в секунду (IOPS) или 2 ГБ/с   |           |           |
| Standard_GS5-8    | **8**  | 448    | 64 | 80 000 операций ввода-вывода в секунду (IOPS) или 2 ГБ/с   | на 75 % ниже | на 42 % ниже |

Так как продукты для баз данных, такие как SQL Server и Oracle, лицензируются по числу ЦП, это позволяет клиентам сократить расходы на лицензирование максимум на 75 процентов и поддерживать при этом высокую производительность, необходимую для баз данных. 
