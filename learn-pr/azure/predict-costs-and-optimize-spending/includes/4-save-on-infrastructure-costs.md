<span data-ttu-id="a94f2-101">Мы узнали, как оценить затраты для сред, которые вы хотите создать, подробно рассмотрели некоторые средства для получения сведений о статьях расходов и спрогнозировали будущие расходы.</span><span class="sxs-lookup"><span data-stu-id="a94f2-101">We have seen how to create cost estimates for environments you'd like to build, walked through some tools to get details on where we're spending money, and projected future expenses.</span></span> <span data-ttu-id="a94f2-102">Наша следующая задача — узнать, как сократить эти расходы на инфраструктуру.</span><span class="sxs-lookup"><span data-stu-id="a94f2-102">Our next challenge is to look at how to reduce those infrastructure costs.</span></span>

## <a name="use-reserved-instances"></a><span data-ttu-id="a94f2-103">Использование зарезервированных экземпляров</span><span class="sxs-lookup"><span data-stu-id="a94f2-103">Use reserved instances</span></span>

<span data-ttu-id="a94f2-104">Если у вас есть статические и предсказуемые по своей природе рабочие нагрузки виртуальных машин, особенно если они работают круглосуточно и без перерывов, зарезервированные экземпляры станут отличным способом сэкономить до 70 % в зависимости от размера виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="a94f2-104">If you have VM workloads that are static and predictable in nature, particularly ones that run 24x7x365, using reserved instances is a fantastic way to potentially save up to 70 percent, depending on the VM size.</span></span>

![Экономия с помощью зарезервированных экземпляров](../images/savings-coins.png)

<span data-ttu-id="a94f2-106">Зарезервированные экземпляры покупаются на один или на три года с предоплатой на весь срок.</span><span class="sxs-lookup"><span data-stu-id="a94f2-106">Reserved instances are purchased in one-year or three-year terms, with payment required for the full term up front.</span></span> <span data-ttu-id="a94f2-107">После приобретения Майкрософт соотносит резервирование с выполняющимися экземплярами и уменьшает количество часов из вашего резервирования.</span><span class="sxs-lookup"><span data-stu-id="a94f2-107">After it's purchased, Microsoft matches up the reservation to running instances and decrements the hours from your reservation.</span></span> <span data-ttu-id="a94f2-108">Резервирования можно приобрести на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="a94f2-108">Reservations can be purchased through the Azure portal.</span></span> <span data-ttu-id="a94f2-109">И так как зарезервированные экземпляры являются скидкой на вычисления, они доступны для виртуальных машин Linux и Windows.</span><span class="sxs-lookup"><span data-stu-id="a94f2-109">And because reserved instances are a compute discount, they are available for both Windows and Linux VMs.</span></span>

## <a name="right-size-underutilized-virtual-machines"></a><span data-ttu-id="a94f2-110">Оценка правильного размера для недостаточно загруженных виртуальных машин</span><span class="sxs-lookup"><span data-stu-id="a94f2-110">Right-size underutilized virtual machines</span></span>

<span data-ttu-id="a94f2-111">Вспомните наше предыдущее обсуждение того, что средство управления затратами Azure и Помощник по Azure могут рекомендовать установку правильного размера или завершение виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="a94f2-111">Recall from our previous discussion that Azure Cost Management and Azure Advisor might recommend right-sizing or shutting down VMs.</span></span> <span data-ttu-id="a94f2-112">Установка правильного размера виртуальной машины — это процесс изменения ее размера до оптимального.</span><span class="sxs-lookup"><span data-stu-id="a94f2-112">Right-sizing a virtual machine is the process of resizing it to a proper size.</span></span> <span data-ttu-id="a94f2-113">Допустим, у вас есть сервер, выполняющий роль контроллера домена, который имеет размер **Standard_D4sv3**, но большую часть времени виртуальная машина простаивает на 90 %.</span><span class="sxs-lookup"><span data-stu-id="a94f2-113">Let's imagine you have a server running as a domain controller that is sized as a **Standard_D4sv3**, but your VM is sitting at 90 percent idle the vast majority of the time.</span></span> <span data-ttu-id="a94f2-114">Если вы измените размер виртуальной машины на **Standard_D2s_v3**, вы сократите затраты на вычисления на 50 %.</span><span class="sxs-lookup"><span data-stu-id="a94f2-114">By resizing this VM to a **Standard_D2s_v3**, you reduce your compute cost by 50 percent.</span></span> <span data-ttu-id="a94f2-115">Затраты рассчитываются линейно и удваиваются с увеличением размера в одной серии.</span><span class="sxs-lookup"><span data-stu-id="a94f2-115">Costs are linear and double for each size larger in the same series.</span></span> <span data-ttu-id="a94f2-116">В этом случае будет лучше даже изменить серию экземпляра и выбрать более экономичную серию виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="a94f2-116">In this case, you might even benefit from changing the instance series to go to a less expensive VM series.</span></span>

![Изменение размера виртуальной машины](../images/vm-resize.png)

<span data-ttu-id="a94f2-118">Слишком большие виртуальные машины — это распространенный источник лишних расходов в Azure, и эту проблему легко устранить.</span><span class="sxs-lookup"><span data-stu-id="a94f2-118">Oversized virtual machines are a common unnecessary expense on Azure and one that is easily fixed.</span></span> <span data-ttu-id="a94f2-119">Вы можете изменить размер виртуальной машины с помощью портала Azure, Azure PowerShell или интерфейса командной строки Azure.</span><span class="sxs-lookup"><span data-stu-id="a94f2-119">You can change the size of a VM through the Azure portal, Azure PowerShell, or the Azure CLI.</span></span>

> [!NOTE]
> <span data-ttu-id="a94f2-120">Чтобы изменить размер виртуальной машины, нужно ее остановить, изменить размер, а затем перезапустить.</span><span class="sxs-lookup"><span data-stu-id="a94f2-120">Resizing a VM requires that it be stopped, resized, and then restarted.</span></span> <span data-ttu-id="a94f2-121">Это может занять несколько минут в зависимости от того, насколько изменяется размер.</span><span class="sxs-lookup"><span data-stu-id="a94f2-121">This may take a few minutes depending on how significant the size change is.</span></span> <span data-ttu-id="a94f2-122">Запланируйте остановку работы или перенесите трафик на другой экземпляр во время выполнения этой задачи.</span><span class="sxs-lookup"><span data-stu-id="a94f2-122">Plan for an outage, or shift your traffic to another instance while you perform this task.</span></span>

## <a name="deallocate-virtual-machines-in-off-hours"></a><span data-ttu-id="a94f2-123">Отмена выделения виртуальных машин в нерабочее время</span><span class="sxs-lookup"><span data-stu-id="a94f2-123">Deallocate virtual machines in off hours</span></span>

<span data-ttu-id="a94f2-124">Если у вас есть рабочие нагрузки виртуальных машин, которые используются только в определенные периоды времени, но вы используете их без перерыва, это лишние расходы.</span><span class="sxs-lookup"><span data-stu-id="a94f2-124">If you have virtual machine workloads that are only used during certain periods of time, but you're running them every hour of every day, you're wasting money.</span></span> <span data-ttu-id="a94f2-125">Виртуальные машины можно легко отключать, когда они не используются, и запускать снова по расписанию, экономя вычислительные ресурсы, когда виртуальная машина не работает.</span><span class="sxs-lookup"><span data-stu-id="a94f2-125">These VMs are great candidates to shut down when not in use and start back up on a schedule, saving you compute costs while the VM is deallocated.</span></span>

<span data-ttu-id="a94f2-126">Это очень удобный подход для сред разработки.</span><span class="sxs-lookup"><span data-stu-id="a94f2-126">This approach is a great strategy for development environments.</span></span> <span data-ttu-id="a94f2-127">Часто разработка осуществляется только в рабочие часы, поэтому вы можете освобождать эти системы в нерабочее время и сократить расходы на вычисления.</span><span class="sxs-lookup"><span data-stu-id="a94f2-127">It's often the case that development may happen only during business hours, giving you the flexibility to deallocate these systems in the off hours and stopping your compute costs from accruing.</span></span> <span data-ttu-id="a94f2-128">Теперь Azure предлагает [решение по автоматизации](https://docs.microsoft.com/azure/automation/automation-solution-vm-management), которое вы можете использовать в своей среде.</span><span class="sxs-lookup"><span data-stu-id="a94f2-128">Azure now has an [automation solution](https://docs.microsoft.com/azure/automation/automation-solution-vm-management) fully available for you to leverage in your environment.</span></span>

<span data-ttu-id="a94f2-129">Вы также можете использовать функцию автоматического завершения работы на виртуальной машине для планирования автоматического завершения работы.</span><span class="sxs-lookup"><span data-stu-id="a94f2-129">You can also use the auto-shutdown feature on a virtual machine to schedule automated shutdowns.</span></span>

![Автоматическое завершение работы](../images/vm-auto-shutdown.png)

## <a name="delete-unused-virtual-machines"></a><span data-ttu-id="a94f2-131">Удаление неиспользуемых виртуальных машин</span><span class="sxs-lookup"><span data-stu-id="a94f2-131">Delete unused virtual machines</span></span> 

 <span data-ttu-id="a94f2-132">Этот совет может показаться очевидным, но если вы не используете службу, следует завершить ее работу.</span><span class="sxs-lookup"><span data-stu-id="a94f2-132">This advice may sound obvious, but if you aren't using a service, you should shut it down.</span></span> <span data-ttu-id="a94f2-133">Нередко можно встретить системы, которые использовались для разработки или подтверждения концепции и продолжают существовать для проекта, который больше не нужен.</span><span class="sxs-lookup"><span data-stu-id="a94f2-133">It's not uncommon to find non-production or proof-of-concept systems left around following a project that is no longer needed.</span></span> <span data-ttu-id="a94f2-134">Регулярно просматривайте свои среды и выявляйте такие системы.</span><span class="sxs-lookup"><span data-stu-id="a94f2-134">Regularly review your environment and work to identify these systems.</span></span> <span data-ttu-id="a94f2-135">Завершение работы этих систем имеет несколько преимуществ и помогает сокращать затраты не только на инфраструктуру, но и на лицензирование и обслуживание.</span><span class="sxs-lookup"><span data-stu-id="a94f2-135">Shutting down these systems can have a multifaceted benefit by saving you not only on infrastructure costs but also potential savings on licensing and operations.</span></span>

## <a name="migrate-to-paas-or-saas-services"></a><span data-ttu-id="a94f2-136">Переход на службы PaaS или SaaS</span><span class="sxs-lookup"><span data-stu-id="a94f2-136">Migrate to PaaS or SaaS services</span></span> 

<span data-ttu-id="a94f2-137">Наконец, при перемещении рабочих нагрузок в облако естественным следующим шагом будет постепенный переход на использование инфраструктуры как услуги (IaaS), а затем платформы как услуги (PaaS).</span><span class="sxs-lookup"><span data-stu-id="a94f2-137">Lastly, as you move workloads to the cloud, a natural evolution is to start with infrastructure-as-a-service (IaaS) services and then move them to platform-as-a-service (PaaS) as appropriate, in an iterative process.</span></span>

<span data-ttu-id="a94f2-138">Службы PaaS, как правило, помогают существенно сэкономить ресурсы и эксплуатационные расходы.</span><span class="sxs-lookup"><span data-stu-id="a94f2-138">PaaS services typically provide substantial savings in both resource and operational costs.</span></span> <span data-ttu-id="a94f2-139">Проблема в том, что в зависимости от типа службы требуется различный объем ресурсов и времени для перехода на эти службы.</span><span class="sxs-lookup"><span data-stu-id="a94f2-139">The challenge is that depending on the type of service, varying levels of effort will be required to move to these services from both a time and resource perspective.</span></span> <span data-ttu-id="a94f2-140">Вам будет легко переместить базу данных SQL Server в базу данных SQL Azure, но потребуется значительно больше усилий для переноса многоуровневого приложения в контейнер или бессерверную архитектуру.</span><span class="sxs-lookup"><span data-stu-id="a94f2-140">You might be able to easily move a SQL Server database to Azure SQL Database, but it might take substantially more effort to move your multitier application to a container or serverless-based architecture.</span></span> <span data-ttu-id="a94f2-141">Рекомендуется постоянно оценивать архитектуру приложения, чтобы определять потенциальную эффективность служб PaaS.</span><span class="sxs-lookup"><span data-stu-id="a94f2-141">It's a good practice to continuously evaluate the architecture of your applications to determine if there are efficiencies to be gained through PaaS services.</span></span>  

<span data-ttu-id="a94f2-142">Azure позволяет тестировать эти службы без лишних усилий и почти без риска, предоставляя вам возможность пробовать новые шаблоны архитектуры с относительной легкостью.</span><span class="sxs-lookup"><span data-stu-id="a94f2-142">Azure makes it easy to test these services with little risk, giving you the ability to try out new architecture patterns relatively easily.</span></span> <span data-ttu-id="a94f2-143">С другой стороны, это решение рассчитано на долгосрочную перспективу, и его преимущества могут быть заметны не сразу.</span><span class="sxs-lookup"><span data-stu-id="a94f2-143">That said, it's typically a longer journey and might not be of immediate help if you're looking for quick wins from a cost-savings perspective.</span></span> <span data-ttu-id="a94f2-144">Центр архитектуры Azure — это отличное место, где можно найти идеи по преобразованию вашего приложения, а также советы и рекомендации по различным архитектурам и службам Azure.</span><span class="sxs-lookup"><span data-stu-id="a94f2-144">The Azure Architecture Center is a great place to get ideas for transforming your application, as well as best practices across a wide array of architectures and Azure services.</span></span> 