Мы узнали, как оценить затраты для сред, которые вы хотите создать, подробно рассмотрели некоторые средства для получения сведений о статьях расходов и спрогнозировали будущие расходы. Наша следующая задача — узнать, как сократить эти расходы на инфраструктуру.

## <a name="use-reserved-instances"></a>Использование зарезервированных экземпляров

Если у вас есть статические и предсказуемые по своей природе рабочие нагрузки виртуальных машин, особенно если они работают круглосуточно и без перерывов, зарезервированные экземпляры станут отличным способом сэкономить до 70 % в зависимости от размера виртуальной машины.

![Экономия с помощью зарезервированных экземпляров](../images/savings-coins.png)

Зарезервированные экземпляры покупаются на один или на три года с предоплатой на весь срок. После приобретения Майкрософт соотносит резервирование с выполняющимися экземплярами и уменьшает количество часов из вашего резервирования. Резервирования можно приобрести на портале Azure. И так как зарезервированные экземпляры являются скидкой на вычисления, они доступны для виртуальных машин Linux и Windows.

## <a name="right-size-underutilized-virtual-machines"></a>Оценка правильного размера для недостаточно загруженных виртуальных машин

Вспомните наше предыдущее обсуждение того, что средство управления затратами Azure и Помощник по Azure могут рекомендовать установку правильного размера или завершение виртуальных машин. Установка правильного размера виртуальной машины — это процесс изменения ее размера до оптимального. Допустим, у вас есть сервер, выполняющий роль контроллера домена, который имеет размер **Standard_D4sv3**, но большую часть времени виртуальная машина простаивает на 90 %. Если вы измените размер виртуальной машины на **Standard_D2s_v3**, вы сократите затраты на вычисления на 50 %. Затраты рассчитываются линейно и удваиваются с увеличением размера в одной серии. В этом случае будет лучше даже изменить серию экземпляра и выбрать более экономичную серию виртуальных машин.

![Изменение размера виртуальной машины](../images/vm-resize.png)

Слишком большие виртуальные машины — это распространенный источник лишних расходов в Azure, и эту проблему легко устранить. Вы можете изменить размер виртуальной машины с помощью портала Azure, Azure PowerShell или интерфейса командной строки Azure.

> [!NOTE]
> Чтобы изменить размер виртуальной машины, нужно ее остановить, изменить размер, а затем перезапустить. Это может занять несколько минут в зависимости от того, насколько изменяется размер. Запланируйте остановку работы или перенесите трафик на другой экземпляр во время выполнения этой задачи.

## <a name="deallocate-virtual-machines-in-off-hours"></a>Отмена выделения виртуальных машин в нерабочее время

Если у вас есть рабочие нагрузки виртуальных машин, которые используются только в определенные периоды времени, но вы используете их без перерыва, это лишние расходы. Виртуальные машины можно легко отключать, когда они не используются, и запускать снова по расписанию, экономя вычислительные ресурсы, когда виртуальная машина не работает.

Это очень удобный подход для сред разработки. Часто разработка осуществляется только в рабочие часы, поэтому вы можете освобождать эти системы в нерабочее время и сократить расходы на вычисления. Теперь Azure предлагает [решение по автоматизации](https://docs.microsoft.com/azure/automation/automation-solution-vm-management), которое вы можете использовать в своей среде.

Вы также можете использовать функцию автоматического завершения работы на виртуальной машине для планирования автоматического завершения работы.

![Автоматическое завершение работы](../images/vm-auto-shutdown.png)

## <a name="delete-unused-virtual-machines"></a>Удаление неиспользуемых виртуальных машин 

 Этот совет может показаться очевидным, но если вы не используете службу, следует завершить ее работу. Нередко можно встретить системы, которые использовались для разработки или подтверждения концепции и продолжают существовать для проекта, который больше не нужен. Регулярно просматривайте свои среды и выявляйте такие системы. Завершение работы этих систем имеет несколько преимуществ и помогает сокращать затраты не только на инфраструктуру, но и на лицензирование и обслуживание.

## <a name="migrate-to-paas-or-saas-services"></a>Переход на службы PaaS или SaaS 

Наконец, при перемещении рабочих нагрузок в облако естественным следующим шагом будет постепенный переход на использование инфраструктуры как услуги (IaaS), а затем платформы как услуги (PaaS).

Службы PaaS, как правило, помогают существенно сэкономить ресурсы и эксплуатационные расходы. Проблема в том, что в зависимости от типа службы требуется различный объем ресурсов и времени для перехода на эти службы. Вам будет легко переместить базу данных SQL Server в базу данных SQL Azure, но потребуется значительно больше усилий для переноса многоуровневого приложения в контейнер или бессерверную архитектуру. Рекомендуется постоянно оценивать архитектуру приложения, чтобы определять потенциальную эффективность служб PaaS.  

Azure позволяет тестировать эти службы без лишних усилий и почти без риска, предоставляя вам возможность пробовать новые шаблоны архитектуры с относительной легкостью. С другой стороны, это решение рассчитано на долгосрочную перспективу, и его преимущества могут быть заметны не сразу. Центр архитектуры Azure — это отличное место, где можно найти идеи по преобразованию вашего приложения, а также советы и рекомендации по различным архитектурам и службам Azure. 