<span data-ttu-id="e1aa2-101">Получив представление о том, как будут храниться данные в учетных записях хранения, контейнерах и больших двоичных объектах, можно подумать, какие ресурсы Azure потребуются для поддержки приложения.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-101">Once we have an idea of how we're going to store data across storage accounts, containers and blobs, we can think about the Azure resources we need to create to support the app.</span></span>

### <a name="storage-accounts"></a><span data-ttu-id="e1aa2-102">учетные записи хранения;</span><span class="sxs-lookup"><span data-stu-id="e1aa2-102">Storage accounts</span></span>

<span data-ttu-id="e1aa2-103">Создание учетной записи хранения — это мероприятие администрирования и управления, выполняемое до развертывания и запуска приложения.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-103">Storage account creation is an administrative/management activity that takes place prior to deploying and running your app.</span></span> <span data-ttu-id="e1aa2-104">Учетные записи обычно создаются путем развертывания, с помощью сценария установки среды или шаблона Azure Resource Manager либо вручную администратором.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-104">Accounts are usually created by a deployment or environment setup script, an Azure Resource Manager template, or manually by an administrator.</span></span> <span data-ttu-id="e1aa2-105">Приложениям, отличным от средств администрирования, обычно не требуются разрешения на создание учетных записей хранения.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-105">Applications other than administrative tools generally should not have permissions to create storage accounts.</span></span>

### <a name="containers"></a><span data-ttu-id="e1aa2-106">Контейнеры</span><span class="sxs-lookup"><span data-stu-id="e1aa2-106">Containers</span></span>

<span data-ttu-id="e1aa2-107">В отличие от создания учетной записи хранения, создание контейнера — это упрощенное действие, которое лучше всего выполнять в приложении.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-107">Unlike storage account creation, container creation is a lightweight activity that makes sense to perform from within an app.</span></span> <span data-ttu-id="e1aa2-108">Довольно часто приложения создают и удаляют контейнеры в процессе работы.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-108">It's not uncommon for apps to create and delete containers as part of their work.</span></span>

<span data-ttu-id="e1aa2-109">Если предложение требует известного набора контейнеров с жестко заданными или предварительно настроенными именами, рекомендуется разрешить ему создавать необходимые контейнеры, если они еще не существуют, при запуске или при первом использовании.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-109">For apps that rely on a known set of containers with hard-coded or preconfigured names, typical practice is to let the app create the containers it needs on startup or first usage if they don't already exist.</span></span> <span data-ttu-id="e1aa2-110">Если вместо того, чтобы создавать контейнеры в процессе развертывания, вы разрешите приложению создавать контейнеры самостоятельно, ни приложению, ни процессу развертывания имена используемых приложением контейнеров не потребуются.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-110">Letting your app create containers instead of doing it as part of your app's deployment eliminates the need for both your application and your deployment process to know the names of the containers the app uses.</span></span>

## <a name="exercise"></a><span data-ttu-id="e1aa2-111">Упражнение</span><span class="sxs-lookup"><span data-stu-id="e1aa2-111">Exercise</span></span>

<span data-ttu-id="e1aa2-112">Завершим незаконченное приложение ASP.NET Core, добавив код для использования хранилища BLOB-объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-112">We're going to complete an unfinished ASP.NET Core app by adding code to use Azure Blob storage.</span></span> <span data-ttu-id="e1aa2-113">Это упражнение относится больше к API хранилища BLOB-объектов, чем к разработке схемы для организации и именования, и все же вот краткие сведения об этом приложении и о том, как оно хранит данные:</span><span class="sxs-lookup"><span data-stu-id="e1aa2-113">This exercise is more about exploring the Blob storage API than it is about designing an organization and naming scheme, but here's a quick overview of the app and how it stores data:</span></span>

<span data-ttu-id="e1aa2-114">**Снимок экрана приложения TODO, поскольку приложение можно будет запустить только в самом конце**</span><span class="sxs-lookup"><span data-stu-id="e1aa2-114">**TODO screenshot of app, since they're not going to see it run until the end**</span></span>

<span data-ttu-id="e1aa2-115">Наше приложение работает как папка общего доступа, которая принимает передаваемые файлы и делает их доступными для загрузки.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-115">Our app works like a shared folder that accepts file uploads and makes them available for download.</span></span> <span data-ttu-id="e1aa2-116">Оно не использует для упорядочивания BLOB-объектов базу данных &mdash; вместо этого приложение очищает имена передаваемых файлов и использует их как имена BLOB-объектов.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-116">It doesn't use a database for organizing blobs &mdash; instead, it sanitizes the names of uploaded files and uses them as blob names directly.</span></span> <span data-ttu-id="e1aa2-117">Все передаваемые файлы хранятся в одном контейнере.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-117">All uploaded files are stored in a single container.</span></span>

<span data-ttu-id="e1aa2-118">Наш исходный код компилируется и работает, однако те его части, которые отвечают за хранение и загрузку данных, пусты.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-118">The code we'll start with compiles and runs, but the parts responsible for storing and loading data are empty.</span></span> <span data-ttu-id="e1aa2-119">Когда код будет готов, мы развернем приложение в службе приложений Azure и протестируем его.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-119">After we complete the code, we'll deploy the app to Azure App Service and test it.</span></span>

<span data-ttu-id="e1aa2-120">Настроим для нашего приложения инфраструктуру хранения данных.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-120">Let's set up the storage infrastructure for our app.</span></span>

### <a name="resource-group-and-storage-account"></a><span data-ttu-id="e1aa2-121">Группа ресурсов и учетная запись хранения</span><span class="sxs-lookup"><span data-stu-id="e1aa2-121">Resource group and storage account</span></span>
<span data-ttu-id="e1aa2-122">Для начала создадим группу ресурсов, в которой будут находиться все ресурсы в этом упражнении.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-122">First, we'll create a resource group to contain all of the resources in this exercise.</span></span> <span data-ttu-id="e1aa2-123">В конце мы ее удалим, чтобы стереть все, что мы насоздавали.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-123">We'll delete it at the end to clean up everything we create.</span></span> <span data-ttu-id="e1aa2-124">Также мы создадим учетную запись хранения, которую наше приложение будет использовать для хранения больших двоичных объектов.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-124">We'll also create the storage account our app will use to store blobs.</span></span>

<span data-ttu-id="e1aa2-125">В терминале Azure Cloud Shell создайте группу ресурсов и учетную запись хранения, выполнив указанные ниже команды интерфейса командной строки Azure.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-125">Use the Azure Cloud Shell terminal to create the resource group and storage account by running the following Azure CLI commands.</span></span> <span data-ttu-id="e1aa2-126">Имя учетной записи хранения должно быть уникальным &mdash; запишите его для последующего использования.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-126">You'll need to provide a unique name for the storage account &mdash; make a note of it for later.</span></span> <span data-ttu-id="e1aa2-127">Выбирать `eastus` в качестве места расположения необязательно.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-127">The choice of `eastus` for the location is arbitrary.</span></span>

```console
az group create --name blob-exercise-group --location eastus
az storage account create --name <your-unique-storage-account-name> --resource-group blob-exercise-group --location eastus --kind StorageV2
```

<span data-ttu-id="e1aa2-128">**Представленный ниже список TODO должен находиться в модуле хранилища Azure**</span><span class="sxs-lookup"><span data-stu-id="e1aa2-128">**TODO below should go in Azure Storage module**</span></span>

> [!NOTE]
> <span data-ttu-id="e1aa2-129">Почему`--kind StorageV2`?</span><span class="sxs-lookup"><span data-stu-id="e1aa2-129">Why `--kind StorageV2`?</span></span> <span data-ttu-id="e1aa2-130">Существует несколько разных видов учетных записей хранения.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-130">There are a few different kinds of storage accounts.</span></span> <span data-ttu-id="e1aa2-131">В большинстве случаев используются учетные записи хранения общего назначения версии 2 (с обозначением `StorageV2`).</span><span class="sxs-lookup"><span data-stu-id="e1aa2-131">For most scenarios, you should use general-purpose v2 storage accounts (signified with `StorageV2`).</span></span> <span data-ttu-id="e1aa2-132">Здесь учетные записи хранения версии 2 указываются только потому, что пока остаются новинкой и еще не используются на портале или в интерфейсе командной строки Azure по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-132">The only reason v2 storage accounts need to be specified here is that they are still fairly new and have not yet been made the default in the Azure Portal or the Azure CLI.</span></span>

### <a name="container"></a><span data-ttu-id="e1aa2-133">Контейнер</span><span class="sxs-lookup"><span data-stu-id="e1aa2-133">Container</span></span>
<span data-ttu-id="e1aa2-134">В приложении, с которым мы будем работать в этом модуле, используется один контейнер.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-134">The app we'll be working with in this module uses a single container.</span></span> <span data-ttu-id="e1aa2-135">Последуем общепринятым рекомендациям и позволим приложению создать контейнер при запуске.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-135">We're going to follow the best practice of letting the app create the container at startup.</span></span> <span data-ttu-id="e1aa2-136">При этом контейнер можно также создать через интерфейс командной строки Azure: выполните команду `az storage container create -h` в терминале Cloud Shell, если хотите увидеть документацию.</span><span class="sxs-lookup"><span data-stu-id="e1aa2-136">However, container creation can be done from the Azure CLI: run `az storage container create -h` in the Cloud Shell terminal if you'd like to see the documentation.</span></span>