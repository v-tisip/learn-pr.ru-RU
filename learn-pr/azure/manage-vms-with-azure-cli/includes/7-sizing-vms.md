Размеры виртуальных машин должны соответствовать ожидаемой рабочей нагрузке. Виртуальная машина без правильного объема памяти или ЦП не выдержит нагрузки или будет работать слишком медленно и неэффективно. 

При создании виртуальной машины можно указать _размер виртуальной машины_, который будет определять объем вычислительных ресурсов, выделенных для этой виртуальной машины. Сюда входят ЦП, GPU и память, которые Azure предоставляет виртуальной машине.

Azure предлагает на выбор несколько [предварительно определенных размеров виртуальных машин](https://docs.microsoft.com/azure/virtual-machines/linux/sizes) для Linux и Windows в зависимости от ожидаемого использования. 

| Тип | Размеры | ОПИСАНИЕ |
|------|-------|-------------|
| Универсальные   | Dsv3, Dv3, DSv2, Dv2, DS, D, Av2, A0–7 | Сбалансированное соотношение ресурсов ЦП и памяти. Идеально подходят для разработки и тестирования малых и средних приложений и решений для обработки данных. |
| Оптимизированные для вычислений | Fs, F | Высокое соотношение ресурсов ЦП и памяти. Подходят для приложений со средним объемом трафика, сетевых устройств и пакетных процессов. |
| Оптимизированные для памяти  | Esv3, Ev3, M, GS, G, DSv2, DS, Dv2, D   | Высокое соотношение ресурсов памяти и числа ядер. Отлично подходят для реляционных баз данных, кэша среднего и большого объема, а также выполняющейся в памяти аналитики. |
| Оптимизированные для хранилища | Ls | Высокая пропускная способность дисков и количество операций ввода-вывода. Идеальный вариант для работы с большими данными, а также с базами данных SQL и NoSQL. |
| Оптимизированные для GPU | NV, NC | Специализированные виртуальные машины, предназначенные для ресурсоемкой отрисовки изображений и редактирования видео. |
| Высокопроизводительные | H, A8–A11 | Виртуальные машины с самыми мощными ЦП, для которых можно настроить сетевые интерфейсы с высокой пропускной способностью (RDMA). | 

Доступные размеры зависят от региона, где вы создаете виртуальную машину. Список доступных размеров можно получить с помощью команды `vm list-sizes`. Попробуйте ввести следующее в Azure Cloud Shell:

```azurecli
az vm list-sizes --location eastus --output table
```

Ниже приведен сокращенный ответ для `eastus`:

```
  MaxDataDiskCount    MemoryInMb  Name                      NumberOfCores    OsDiskSizeInMb    ResourceDiskSizeInMb
------------------  ------------  ----------------------  ---------------  ----------------  ----------------------
                 2          2048  Standard_B1ms                         1           1047552                    4096
                 2          1024  Standard_B1s                          1           1047552                    2048
                 4          8192  Standard_B2ms                         2           1047552                   16384
                 4          4096  Standard_B2s                          2           1047552                    8192
                 8         16384  Standard_B4ms                         4           1047552                   32768
                16         32768  Standard_B8ms                         8           1047552                   65536
                 4          3584  Standard_DS1_v2                       1           1047552                    7168
                 8          7168  Standard_DS2_v2                       2           1047552                   14336
                16         14336  Standard_DS3_v2                       4           1047552                   28672
                32         28672  Standard_DS4_v2                       8           1047552                   57344
                64         57344  Standard_DS5_v2                      16           1047552                  114688
        ....
                64       3891200  Standard_M128-32ms                  128           1047552                 4096000
                64       3891200  Standard_M128-64ms                  128           1047552                 4096000
                64       3891200  Standard_M128ms                     128           1047552                 4096000
                64       2048000  Standard_M128s                      128           1047552                 4096000
                64       1024000  Standard_M64                         64           1047552                 8192000
                64       1792000  Standard_M64m                        64           1047552                 8192000
                64       2048000  Standard_M128                       128           1047552                16384000
                64       3891200  Standard_M128m                      128           1047552                16384000
```

Мы не указали размер при создании виртуальной машины, поэтому Azure выбрал универсальный размер — `Standard_DS1_v2`. Но мы можем указать размер с помощью команды `vm create` с параметром `--size`. Например, используйте следующую команду для создания виртуальной машины на 16 ядер:

```azurecli
az vm create --resource-group ExerciseResources --name SampleVM \
  --image Debian --admin-username aldis --generate-ssh-keys --verbose \
  --size "Standard_DS5_v2"
```

> [!WARNING]
> Ваш уровень подписки [ограничивает](https://docs.microsoft.com/en-us/azure/azure-subscription-service-limits) количество ресурсов, которые вы можете создавать, а также общий размер этих ресурсов. Например, ваш максимум — **20 виртуальных ЦП** с оплатой по мере использования и только **4 виртуальных ЦП** на бесплатном уровне. Azure CLI сообщит вам при превышении лимита, выдав ошибку **Превышена квота**. Если при создании архитектуры у вас возникнет эта ошибка, вы можете запросить увеличение лимита по платной подписке (до 10 000 виртуальных ЦП!), отравив [бесплатный онлайн-запрос](https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-manager-quota-errors). 

## <a name="resizing-an-existing-vm"></a>Изменение размера существующей виртуальной машины
Можно также изменить размеры существующей виртуальной машины при изменении рабочей нагрузки или при выборе неправильного размера во время создания. Перед отправкой запроса на изменение размера мы должны проверить, доступен ли желаемый размер в кластере, где расположена наша виртуальная машина. Это можно сделать с помощью команды `vm list-vm-resize-options`:

```azurecli
az vm list-vm-resize-options --resource-group ExerciseResources --name SampleVM --output table
```

Отобразится список всех возможных конфигураций размера, доступных в группе ресурсов. Если желаемый размер недоступен в нашем кластере, но _доступен_ в регионе, мы можем [освободить виртуальную машину](https://docs.microsoft.com/cli/azure/vm?view=azure-cli-latest#az-vm-deallocate). Эта команда остановит работу виртуальной машины и удалит ее из текущего кластера, сохраняя при этом все ресурсы. Затем мы можем изменить размер и повторно создать виртуальную машину в кластере, где желаемый размер доступен.

Чтобы изменить размер виртуальной машины, мы используем команду `vm resize`. Например, давайте сократим ресурсы виртуальной машины до минимума: 2 ГБ памяти, 1 ядро ЦП и 4 ГБ места на диске. Введите следующую команду в Cloud Shell:

```azurecli
az vm resize --resource-group ExerciseResources --name SampleVM --size "Standard_B1ms"
```

Потребуется несколько минут, чтобы сократить количество ресурсов для виртуальной машины, а затем команда возвращает новую конфигурацию JSON.